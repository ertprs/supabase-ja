---
id: going-into-prod
title: 本番稼働前のチェックリスト
description: 'Things to do before making your app publicly available'
---

プロジェクトを開発し、実際のユーザーに公開する時が来たと判断したら、以下のチェックリストを実行して、プロジェクトの安全性を確認する必要があります。

- 安全であること
- 予想される負荷に耐えられること
- 本番環境でも利用可能であること

## セキュリティー

<<<<<<< HEAD
- RLSが有効であること
    - 妥当なポリシーでRLSを有効にしていないテーブルでは、すべてのクライアントがデータにアクセスして変更できます。これは、ほとんどの場合、お客様が望むことではないでしょう。
    - [RLSの詳細はこちら](/docs/guides/auth/row-level-security)を参照ください。
- 機密データを含むテーブルのレプリケーションを確実に無効にする。
    - 現在、RealtimeはRLSポリシーを尊重しておらず、あなたのアノンキーを持つどのクライアントも、レプリケーションが有効になっているテーブルの変更を聞くことができます。
    - Supabaseダッシュボードの「データベース」→「レプリケーション」ページでこれらの設定を管理してください。
    - 近日中に[RLSのリアルタイム](https://github.com/supabase/walrus)化を予定していますが、それまでは公開データを含むテーブル（スコアボード、ブログ記事など）にのみ使用してください。
- Githubで2FAを有効にする
    - GithubアカウントにはSupabaseプロジェクトの管理者権限が与えられているため、強力なパスワードとU2FキーやTOTPアプリを使った2FAで保護する必要があります。
- Auth → Settingsページでメール確認が有効になっていることを確認する。
- 認証メールにカスタムSMTPサーバーを使用します。信頼できるドメインからメールが来ていることをユーザーが確認できるようにします（SendGrid、AWS SESなどの主要なメールプロバイダーからSMTP認証情報を取得してください）。メールサーバのドメインはアプリがホストされているのと同じドメインが望ましいです。
- 攻撃者としてどのようにサービスを悪用*する*かをよく考え、軽減する。
- これらの[一般的なサイバーセキュリティ上の脅威](https://auth0.com/docs/security/prevent-threats)を確認する。
=======
- Ensure RLS is enabled
    - Tables that do not have RLS enabled with reasonable policies allow any client to access and modify their data. This is unlikely to be what you want in the majority of cases.
    - [Learn more about RLS](/docs/guides/auth/row-level-security)
- Enable replication on tables containing sensitive data by enabling Row Level Security (RLS) and setting row security policies:
    - Go to the Authentication > Policies page in the Supabase Dashboard to enable RLS and create security policies
    - Go to the Database > Replication page in the Supabase Dashboard to manage replication tables
- Enable 2FA on Github
    - Since your Github account gives you administrative rights to your Supabase project, you should protect it with a strong password and 2FA using a U2F key or a TOTP app.
- Ensure email confirmations are enabled in the Auth > Settings page
- Use a custom SMTP server for auth emails so that your users can see that the mails are coming from a trusted domain (preferably the same domain that your app is hosted on). (grab SMTP credentials from any major email provider such as SendGrid, AWS SES, etc.)
- Think hard about how *you* would abuse your service as an attacker, and mitigate
- Review these [common cybersecurity threats](https://auth0.com/docs/security/prevent-threats)
>>>>>>> 77932bfc2d890a633bf78cdf35bd89cc1a8de957

## パフォーマンス

- 一般的なクエリパターンに対応する適切なインデックスを用意する
    - [Postgresのインデックスについての詳細](https://www.enterprisedb.com/postgres-tutorials/overview-postgresql-indexes)。
    - pg_stat_statementsは、[ホットまたはスローなクエリを特定する](https://www.virtual-dba.com/blog/postgresql-performance-identifying-hot-and-slow-queries/)のに役立ちます。
- 負荷テストの実施（できればステージング環境で）
    - [k6](https://k6.io/)のようなツールを使用すると、多くの異なるユーザーからのトラフィックをシミュレートできます。
- より多くのリソースが必要な場合は、<support@supabase.io>に連絡して、より大きなサーバーのPAYGにアップグレードしてください。

## 利用可能性

- 独自のSMTP認証情報を使用することで、トランザクション認証メールの配信を完全にコントロールできます（Auth → Settingsを参照）。
    - SMTP認証情報は、SendGridやAWS SESなどの主要なメールプロバイダーから取得できます。
    - Supabaseが提供する認証メールのデフォルトの制限値は、1時間あたり30人の新規ユーザーですが、大規模な公開する場合は、これ以上の数が必要になる可能性があります。
- お客様のアプリケーションが無料版であり、少なくとも7日に1回の問い合わせが**ない**と予想される場合、Supabaseはサーバーのリソースを節約するためにアプリケーションを一時停止します。
    - 一時停止されたプロジェクトは、Supabaseのダッシュボードから復元できます。
    - Proにアップグレードすると、活動していないことを理由にプロジェクトが一時停止されることはありません。
- 無料版では、データベースのバックアップをダウンロードできません。
    - [pg_dump](https://www.postgresqltutorial.com/postgresql-backup-database/)や[wal-g](https://github.com/wal-g/wal-g)などのツールを使って独自のバックアップシステムを構築できます。
    - Pro Tierのプロジェクトのナイトリーバックアップは、Supabaseのダッシュボードで最大7日間利用可能です。
- Supabase Pro Tierにアップグレードすると、<support@supabase.io>のメールサポートを受けることができます。

このチェックリストは常に成長していますので、頻繁にチェックしてください。また、追加や修正を提案する場合は、[Github](https://github.com/supabase/supabase)にPRを作成してください。
